<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ระบบหลังบ้าน Admin</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background:#f0f0f0; padding:20px; }
  h2 { color:#007aff; }
  table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 0 8px #ccc; margin-bottom: 20px; }
  th, td { padding: 10px; border-bottom: 1px solid #eee; text-align: left; }
  th { background: #007aff; color: white; }
  select, input, button, textarea { font-size: 16px; padding: 8px; margin: 5px 0; border-radius: 6px; border: 1px solid #ccc; width: 100%; box-sizing: border-box; }
  button { background: #007aff; color: white; border: none; cursor: pointer; }
  button:hover { background: #005bb5; }
  .btn-delete { background: #ff3b30; width: auto; padding: 6px 12px; }
  .btn-delete:hover { background: #d32f2f; }
  .section { background: white; padding: 15px; border-radius: 8px; margin-bottom: 25px; box-shadow: 0 0 10px #ccc; }
</style>
</head>
<body>

<h1>ระบบหลังบ้าน Admin</h1>

<div class="section">
  <h2>1. จัดการสมาชิก</h2>
  <table id="users-table">
    <thead>
      <tr>
        <th>ชื่อผู้ใช้</th>
        <th>เบอร์โทร</th>
        <th>โปรเน็ตที่สมัคร</th>
        <th>สถานะบัญชี</th>
        <th>ลบ</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<div class="section">
  <h2>2. เพิ่ม/แก้ไข โปรเน็ต</h2>
  <form id="add-package-form">
    <input type="text" id="package-name" placeholder="ชื่อโปรเน็ต" required />
    <input type="number" id="package-price" placeholder="ราคา (บาท)" required min="0" />
    <button type="submit">เพิ่มโปรเน็ต</button>
  </form>

  <h3>โปรเน็ตที่มีอยู่</h3>
  <ul id="package-list"></ul>
</div>

<div class="section">
  <h2>3. ข่าวแจ้งเตือนลูกค้า</h2>
  <form id="add-notice-form">
    <textarea id="notice-text" placeholder="พิมพ์ข้อความแจ้งเตือน..." rows="3" required></textarea>
    <button type="submit">เพิ่มแจ้งเตือน</button>
  </form>

  <h3>รายการแจ้งเตือน</h3>
  <ul id="notice-list"></ul>
</div>

<script>
// โหลดข้อมูล users, packages, notices จาก localStorage หรือสร้างใหม่ถ้ายังไม่มี
let users = JSON.parse(localStorage.getItem('users') || '[]');
let packages = JSON.parse(localStorage.getItem('packages') || '[]');
let notices = JSON.parse(localStorage.getItem('notices') || '[]');

const usersTableBody = document.querySelector('#users-table tbody');
const packageList = document.getElementById('package-list');
const noticeList = document.getElementById('notice-list');

// ฟังก์ชันแสดงสมาชิก พร้อม dropdown เปลี่ยนสถานะ
function renderUsers() {
  usersTableBody.innerHTML = '';
  users.forEach((user, i) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${user.username}</td>
      <td>${user.phone}</td>
      <td>${user.net}</td>
      <td>
        <select data-index="${i}">
          <option value="Active" ${user.status === 'Active' ? 'selected' : ''}>Active</option>
          <option value="Inactive" ${user.status === 'Inactive' ? 'selected' : ''}>Inactive</option>
          <option value="Suspended" ${user.status === 'Suspended' ? 'selected' : ''}>Suspended</option>
        </select>
      </td>
      <td><button class="btn-delete" data-index="${i}">ลบ</button></td>
    `;
    // เปลี่ยนสถานะ
    tr.querySelector('select').addEventListener('change', (e) => {
      let idx = e.target.getAttribute('data-index');
      users[idx].status = e.target.value;
      saveUsers();
    });
    // ลบสมาชิก
    tr.querySelector('button').addEventListener('click', () => {
      users.splice(i, 1);
      saveUsers();
      renderUsers();
    });
    usersTableBody.appendChild(tr);
  });
}

// บันทึก users ลง localStorage
function saveUsers() {
  localStorage.setItem('users', JSON.stringify(users));
}

// ฟังก์ชันแสดงโปรเน็ต
function renderPackages() {
  packageList.innerHTML = '';
  packages.forEach((pkg, i) => {
    const li = document.createElement('li');
    li.textContent = `${pkg.name} - ราคา ${pkg.price} บาท`;
    packageList.appendChild(li);
  });
}

// เพิ่มโปรเน็ต
document.getElementById('add-package-form').addEventListener('submit', (e) => {
  e.preventDefault();
  const name = document.getElementById('package-name').value.trim();
  const price = parseFloat(document.getElementById('package-price').value);
  if(name && price >= 0){
    packages.push({name, price});
    localStorage.setItem('packages', JSON.stringify(packages));
    renderPackages();
    e.target.reset();
  }
});

// ฟังก์ชันแสดงแจ้งเตือน
function renderNotices() {
  noticeList.innerHTML = '';
  notices.forEach((notice, i) => {
    const li = document.createElement('li');
    li.textContent = notice;
    noticeList.appendChild(li);
  });
}

// เพิ่มแจ้งเตือน
document.getElementById('add-notice-form').addEventListener('submit', (e) => {
  e.preventDefault();
  const text = document.getElementById('notice-text').value.trim();
  if(text){
    notices.push(text);
    localStorage.setItem('notices', JSON.stringify(notices));
    renderNotices();
    e.target.reset();
  }
});

// เริ่มต้น
renderUsers();
renderPackages();
renderNotices();
</script>

</body>
</html>
