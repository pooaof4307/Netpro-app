
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>โพสต์ขายไอดีเกม</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#4CAF50">
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; padding: 20px; }
    .post-box { max-width: 600px; margin: auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .form-group { margin-bottom: 15px; }
    .form-group input, .form-group textarea { width: 100%; padding: 10px; margin-top: 5px; }
    .image-preview img { width: 80px; height: 80px; object-fit: cover; margin-right: 10px; }
    .share-buttons button { margin-right: 10px; padding: 8px 12px; }
  </style>
</head>
<body>
  <div class="post-box">
    <h2>โพสต์ขายไอดีเกม</h2>
    <div><strong>ผู้ใช้:</strong> <span id="usernameDisplay">Guest</span></div>
    <div class="form-group">
      <label>ข้อความ</label>
      <textarea id="postText" rows="4"></textarea>
    </div>
    <div class="form-group">
      <label>พื้นหลัง</label>
      <input type="color" id="bgColor" value="#ffffff">
    </div>
    <div class="form-group">
      <label>สีตัวอักษร</label>
      <input type="color" id="textColor" value="#000000">
    </div>
    <div class="form-group">
      <label>แนบรูป (ไม่เกิน 10)</label>
      <input type="file" id="images" accept="image/*" multiple>
      <div class="image-preview" id="imagePreview"></div>
    </div>
    <div class="form-group">
      <label>ตำแหน่ง</label>
      <input type="text" id="location" placeholder="ตำแหน่งหรือให้ระบบหาตำแหน่ง">
      <button onclick="getLocation()">ดึงตำแหน่ง</button>
    </div>
    <button onclick="submitPost()">โพสต์</button>
    <div class="form-group share-buttons">
      <label>แชร์โพสต์:</label><br>
      <button onclick="shareFacebook()">Facebook</button>
      <button onclick="shareLine()">LINE</button>
      <button onclick="shareTwitter()">Twitter</button>
    </div>
    <div id="preview"></div>
  </div>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(reg => console.log('SW registered!', reg))
        .catch(err => console.log('SW failed!', err));
    }

    let username = localStorage.getItem("username") || "Guest";
    document.getElementById("usernameDisplay").textContent = username;

    const imageInput = document.getElementById('images');
    const previewContainer = document.getElementById('imagePreview');

    imageInput.addEventListener('change', () => {
      previewContainer.innerHTML = "";
      const files = Array.from(imageInput.files).slice(0, 10);
      files.forEach(file => {
        const reader = new FileReader();
        reader.onload = e => {
          const img = document.createElement('img');
          img.src = e.target.result;
          previewContainer.appendChild(img);
        };
        reader.readAsDataURL(file);
      });
    });

    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(pos => {
          document.getElementById("location").value = pos.coords.latitude + "," + pos.coords.longitude;
        });
      }
    }

    function submitPost() {
      alert("ระบบโพสต์เสร็จสิ้น (ตัวอย่าง)");
    }

    function shareFacebook() {
      const url = encodeURIComponent(window.location.href);
      window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
    }

    function shareLine() {
      const url = encodeURIComponent(window.location.href);
      window.open(`https://social-plugins.line.me/lineit/share?url=${url}`, '_blank');
    }

    function shareTwitter() {
      const url = encodeURIComponent(window.location.href);
      const text = encodeURIComponent("ดูโพสต์ของฉันบนเว็บ!");
      window.open(`https://twitter.com/intent/tweet?url=${url}&text=${text}`, '_blank');
    }
  </script>
</body>
</html>
