<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πÄ‡∏ô‡πá‡∏ï</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@500&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      background-color: #121212;
      color: #eee;
      margin: 0; padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }
    header {
      background: #1f1f1f;
      width: 100%;
      padding: 1.5rem 2rem;
      box-shadow: 0 2px 10px #000;
      font-size: 1.6rem;
      font-weight: 600;
      color: #d4af37;
      user-select: none;
      text-align: center;
    }
    main {
      flex-grow: 1;
      width: 100%;
      max-width: 960px;
      padding: 2rem;
    }
    form {
      background: #222;
      padding: 1.8rem 2rem;
      border-radius: 12px;
      box-shadow: 0 0 20px #bfa76f33;
      margin-bottom: 2rem;
    }
    form > div {
      margin-bottom: 1rem;
    }
    label {
      display: block;
      margin-bottom: 0.4rem;
      font-weight: 600;
      color: #d4af37;
    }
    input[type="text"],
    input[type="number"],
    textarea {
      width: 100%;
      padding: 10px 14px;
      border: none;
      border-radius: 8px;
      background: #333;
      color: #eee;
      font-size: 1rem;
      resize: vertical;
    }
    textarea {
      min-height: 70px;
    }
    button {
      background: #d4af37;
      border: none;
      padding: 12px 28px;
      border-radius: 30px;
      font-size: 1.1rem;
      font-weight: 700;
      color: #121212;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background: #f0d473;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #222;
      box-shadow: 0 0 20px #bfa76f33;
      border-radius: 12px;
      overflow: hidden;
    }
    th, td {
      padding: 12px 16px;
      text-align: left;
      color: #eee;
      border-bottom: 1px solid #444;
    }
    th {
      background: #2f2f2f;
      font-weight: 700;
      color: #d4af37;
      user-select: none;
    }
    tr:hover {
      background: #333;
    }
    .action-btn {
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 1.2rem;
      margin-right: 8px;
      color: #d4af37;
      transition: color 0.25s ease;
    }
    .action-btn:hover {
      color: #f0d473;
    }
    .msg {
      margin-bottom: 1rem;
      padding: 0.8rem 1.2rem;
      background: #444;
      border-radius: 10px;
      color: #d4af37;
      font-weight: 600;
      text-align: center;
      user-select: none;
    }
  </style>
</head>
<body>
  <header>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πÄ‡∏ô‡πá‡∏ï (Admin Dashboard)</header>

  <main>
    <form id="packageForm">
      <input type="hidden" id="packageId" value="" />
      <div>
        <label for="network">‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢</label>
        <input type="text" id="network" placeholder="‡πÄ‡∏ä‡πà‡∏ô AIS, True, Dtac" required />
      </div>
      <div>
        <label for="price">‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
        <input type="number" id="price" min="0" placeholder="‡πÄ‡∏ä‡πà‡∏ô 299" required />
      </div>
      <div>
        <label for="speed">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß</label>
        <input type="text" id="speed" placeholder="‡πÄ‡∏ä‡πà‡∏ô 5GB/‡∏ß‡∏±‡∏ô" required />
      </div>
      <div>
        <label for="duration">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤</label>
        <input type="text" id="duration" placeholder="‡πÄ‡∏ä‡πà‡∏ô 7 ‡∏ß‡∏±‡∏ô" required />
      </div>
      <div>
        <label for="description">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
        <textarea id="description" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏ô‡πá‡∏ï‡πÑ‡∏°‡πà‡∏≠‡∏±‡πâ‡∏ô, ‡πÇ‡∏ó‡∏£‡∏ü‡∏£‡∏µ"></textarea>
      </div>
      <button type="submit" id="submitBtn">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏ô‡πá‡∏ï</button>
    </form>

    <div class="msg" id="message" style="display:none;"></div>

    <table id="packageTable" aria-label="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πÄ‡∏ô‡πá‡∏ï">
      <thead>
        <tr>
          <th>‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢</th>
          <th>‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</th>
          <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß</th>
          <th>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤</th>
          <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
          <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
        </tr>
      </thead>
      <tbody>
        <!-- ‡πÅ‡∏ñ‡∏ß‡πÇ‡∏õ‡∏£‡πÄ‡∏ô‡πá‡∏ï‡∏à‡∏∞‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
      </tbody>
    </table>
  </main>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyV7B2AfgmmULrTdOPbI6oRbJtF3FRM6_4vvHOrJBvrutWKKH0yaa0gEWRyz95cd4gy8Q/exec';

    const form = document.getElementById('packageForm');
    const packageIdInput = document.getElementById('packageId');
    const networkInput = document.getElementById('network');
    const priceInput = document.getElementById('price');
    const speedInput = document.getElementById('speed');
    const durationInput = document.getElementById('duration');
    const descriptionInput = document.getElementById('description');
    const submitBtn = document.getElementById('submitBtn');
    const messageDiv = document.getElementById('message');
    const tbody = document.querySelector('#packageTable tbody');

    let packages = [];

    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
    function showMessage(text, duration = 3000) {
      messageDiv.textContent = text;
      messageDiv.style.display = 'block';
      setTimeout(() => messageDiv.style.display = 'none', duration);
    }

    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÄ‡∏ô‡πá‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    async function loadPackages() {
      try {
        const res = await fetch(scriptURL);
        if (!res.ok) throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
        const data = await res.json();
        packages = data.records || [];
        renderTable();
      } catch (err) {
        showMessage('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß');
        console.error(err);
      }
    }

    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
    function renderTable() {
      if (packages.length === 0) {
        tbody.innerHTML = `<tr><td colspan="6" style="text-align:center;color:#d4af37;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏õ‡∏£‡πÄ‡∏ô‡πá‡∏ï‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</td></tr>`;
        return;
      }
      tbody.innerHTML = packages.map((pkg, idx) => `
        <tr>
          <td>${pkg.network}</td>
          <td>${pkg.price}</td>
          <td>${pkg.speed}</td>
          <td>${pkg.duration}</td>
          <td>${pkg.description || '-'}</td>
          <td>
            <button class="action-btn" aria-label="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏õ‡∏£‡πÄ‡∏ô‡πá‡∏ï" data-index="${idx}" onclick="editPackage(${idx})">‚úèÔ∏è</button>
            <button class="action-btn" aria-label="‡∏•‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏ô‡πá‡∏ï" data-index="${idx}" onclick="deletePackage(${idx})">üóëÔ∏è</button>
          </td>
        </tr>
      `).join('');
    }

    // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°
    function resetForm() {
      packageIdInput.value = '';
      form.reset();
      submitBtn.textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏ô‡πá‡∏ï';
    }

    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏õ‡∏£‡πÄ‡∏ô‡πá‡∏ï
    form.addEventListener('submit', async e => {
      e.preventDefault();

      const network = networkInput.value.trim();
      const price = priceInput.value.trim();
      const speed = speedInput.value.trim
