<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ระบบหลังบ้าน - สมาชิก</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background:#f9f9f9; padding: 20px; }
  h2 { margin-bottom: 10px; }
  #summary { margin-bottom: 20px; padding: 10px; background: #fff; border-radius: 8px; box-shadow: 0 0 5px #ccc; }
  table { width: 100%; border-collapse: collapse; background: #fff; border-radius: 8px; overflow: hidden; box-shadow: 0 0 5px #ccc; }
  th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; }
  th { background: #007aff; color: white; }
  button { padding: 6px 12px; background: #ff3b30; color: white; border: none; border-radius: 4px; cursor: pointer; }
  button:hover { background: #d32f2f; }
</style>
</head>
<body>

<h2>สรุปสมาชิก</h2>
<div id="summary">
  <div>จำนวนสมาชิก: <span id="total-users">0</span></div>
  <div>สถานะบัญชีสมาชิก:</div>
  <ul id="status-list"></ul>
</div>

<h2>ข้อมูลสมาชิก</h2>
<table id="users-table">
  <thead>
    <tr>
      <th>ชื่อผู้ใช้</th>
      <th>เบอร์โทร</th>
      <th>โปรเน็ตที่สมัคร</th>
      <th>สถานะบัญชี</th>
      <th>ลบ</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
// ตัวอย่างข้อมูลสมาชิกเก็บใน localStorage
// structure: [{username, phone, net, status}, ...]
if (!localStorage.getItem('users')) {
  localStorage.setItem('users', JSON.stringify([
    { username: "somchai", phone: "0812345678", net: "โปรเน็ต A", status: "Active" },
    { username: "somsri", phone: "0898765432", net: "โปรเน็ต B", status: "Inactive" }
  ]));
}

const usersTableBody = document.querySelector('#users-table tbody');
const totalUsersSpan = document.getElementById('total-users');
const statusList = document.getElementById('status-list');

function renderUsers() {
  let users = JSON.parse(localStorage.getItem('users') || '[]');
  usersTableBody.innerHTML = '';

  // แสดงจำนวนสมาชิก
  totalUsersSpan.textContent = users.length;

  // นับสถานะสมาชิกแต่ละประเภท
  let statusCount = {};
  users.forEach(user => {
    statusCount[user.status] = (statusCount[user.status] || 0) + 1;
  });

  // แสดงสถานะบัญชี
  statusList.innerHTML = '';
  for (const [status, count] of Object.entries(statusCount)) {
    const li = document.createElement('li');
    li.textContent = `${status}: ${count} คน`;
    statusList.appendChild(li);
  }

  // แสดงข้อมูลสมาชิกในตาราง
  users.forEach((user, i) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${user.username}</td>
      <td>${user.phone}</td>
      <td>${user.net}</td>
      <td>${user.status}</td>
      <td><button data-index="${i}">ลบ</button></td>
    `;
    tr.querySelector('button').addEventListener('click', () => {
      deleteUser(i);
    });
    usersTableBody.appendChild(tr);
  });
}

function deleteUser(index) {
  let users = JSON.parse(localStorage.getItem('users') || '[]');
  users.splice(index, 1);
  localStorage.setItem('users', JSON.stringify(users));
  renderUsers();
}

renderUsers();
</script>

</body>
</html>
